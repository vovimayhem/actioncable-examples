#! /bin/bash
set -e

SERVICE_NAME=$1
CONTAINER_NAME=(`docker-compose ps | grep "${SERVICE_NAME}_"`)
shift
CONTAINER_COMMAND=$@
if [ -z "${CONTAINER_NAME}" ]; then
  echo "Running command on a new container..."
  docker-compose run --rm ${SERVICE_NAME} ${CONTAINER_COMMAND}
else
  echo "Running command on existing container ${CONTAINER_NAME}..."
  docker exec -ti ${CONTAINER_NAME} ${CONTAINER_COMMAND}
fi
